(()=>{var br=Object.create,Ue=Object.defineProperty,xr=Object.getPrototypeOf,Er=Object.prototype.hasOwnProperty,Dr=Object.getOwnPropertyNames,Tr=Object.getOwnPropertyDescriptor;var qr=e=>Ue(e,"__esModule",{value:!0});var O=(e,n)=>()=>(n||(n={exports:{}},e(n.exports,n)),n.exports);var Cr=(e,n,a)=>{if(qr(e),n&&typeof n=="object"||typeof n=="function")for(let f of Dr(n))!Er.call(e,f)&&f!=="default"&&Ue(e,f,{get:()=>n[f],enumerable:!(a=Tr(n,f))||a.enumerable});return e},Sr=e=>e&&e.__esModule?e:Cr(Ue(e!=null?br(xr(e)):{},"default",{value:e,enumerable:!0}),e);var te=O((Sn,ht)=>{"use strict";function ae(e,n,a,f,m,h){return{tag:e,key:n,attrs:a,children:f,text:m,dom:h,domSize:void 0,state:void 0,events:void 0,instance:void 0}}ae.normalize=function(e){return Array.isArray(e)?ae("[",void 0,void 0,ae.normalizeChildren(e),void 0,void 0):e==null||typeof e=="boolean"?null:typeof e=="object"?e:ae("#",void 0,void 0,String(e),void 0,void 0)};ae.normalizeChildren=function(e){var n=[];if(e.length){for(var a=e[0]!=null&&e[0].key!=null,f=1;f<e.length;f++)if((e[f]!=null&&e[f].key!=null)!==a)throw new TypeError("Vnodes must either always have keys or never have keys!");for(var f=0;f<e.length;f++)n[f]=ae.normalize(e[f])}return n};ht.exports=ae});var Be=O((jn,pt)=>{"use strict";var jr=te();pt.exports=function(){var e=arguments[this],n=this+1,a;if(e==null?e={}:(typeof e!="object"||e.tag!=null||Array.isArray(e))&&(e={},n=this),arguments.length===n+1)a=arguments[n],Array.isArray(a)||(a=[a]);else for(a=[];n<arguments.length;)a.push(arguments[n++]);return jr("",e.key,e,a)}});var He=O((In,mt)=>{"use strict";var gt=te(),Ir=Be(),Pr=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,dt={},le={}.hasOwnProperty;function yt(e){for(var n in e)if(le.call(e,n))return!1;return!0}function Nr(e){for(var n,a="div",f=[],m={};n=Pr.exec(e);){var h=n[1],c=n[2];if(h===""&&c!=="")a=c;else if(h==="#")m.id=c;else if(h===".")f.push(c);else if(n[3][0]==="["){var o=n[6];o&&(o=o.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),n[4]==="class"?f.push(o):m[n[4]]=o===""?o:o||!0}}return f.length>0&&(m.className=f.join(" ")),dt[e]={tag:a,attrs:m}}function Ar(e,n){var a=n.attrs,f=gt.normalizeChildren(n.children),m=le.call(a,"class"),h=m?a.class:a.className;if(n.tag=e.tag,n.attrs=null,n.children=void 0,!yt(e.attrs)&&!yt(a)){var c={};for(var o in a)le.call(a,o)&&(c[o]=a[o]);a=c}for(var o in e.attrs)le.call(e.attrs,o)&&o!=="className"&&!le.call(a,o)&&(a[o]=e.attrs[o]);(h!=null||e.attrs.className!=null)&&(a.className=h!=null?e.attrs.className!=null?String(e.attrs.className)+" "+String(h):h:e.attrs.className!=null?e.attrs.className:null),m&&(a.class=null);for(var o in a)if(le.call(a,o)&&o!=="key"){n.attrs=a;break}return Array.isArray(f)&&f.length===1&&f[0]!=null&&f[0].tag==="#"?n.text=f[0].children:n.children=f,n}function Mr(e){if(e==null||typeof e!="string"&&typeof e!="function"&&typeof e.view!="function")throw Error("The selector must be either a string or a component.");var n=Ir.apply(1,arguments);return typeof e=="string"&&(n.children=gt.normalizeChildren(n.children),e!=="[")?Ar(dt[e]||Nr(e),n):(n.tag=e,n)}mt.exports=Mr});var bt=O((Pn,wt)=>{"use strict";var vr=te();wt.exports=function(e){return e==null&&(e=""),vr("<",void 0,void 0,e,void 0,void 0)}});var Et=O((Nn,xt)=>{"use strict";var Or=te(),Lr=Be();xt.exports=function(){var e=Lr.apply(0,arguments);return e.tag="[",e.children=Or.normalizeChildren(e.children),e}});var Tt=O((An,Dt)=>{"use strict";var Fe=He();Fe.trust=bt();Fe.fragment=Et();Dt.exports=Fe});var $e=O((Mn,qt)=>{"use strict";var U=function(e){if(!(this instanceof U))throw new Error("Promise must be called with `new`");if(typeof e!="function")throw new TypeError("executor must be a function");var n=this,a=[],f=[],m=u(a,!0),h=u(f,!1),c=n._instance={resolvers:a,rejectors:f},o=typeof setImmediate=="function"?setImmediate:setTimeout;function u(w,b){return function g(p){var E;try{if(b&&p!=null&&(typeof p=="object"||typeof p=="function")&&typeof(E=p.then)=="function"){if(p===n)throw new TypeError("Promise can't be resolved w/ itself");y(E.bind(p))}else o(function(){!b&&w.length===0&&console.error("Possible unhandled promise rejection:",p);for(var x=0;x<w.length;x++)w[x](p);a.length=0,f.length=0,c.state=b,c.retry=function(){g(p)}})}catch(x){h(x)}}}function y(w){var b=0;function g(E){return function(x){b++>0||E(x)}}var p=g(h);try{w(g(m),p)}catch(E){p(E)}}y(e)};U.prototype.then=function(e,n){var a=this,f=a._instance;function m(u,y,w,b){y.push(function(g){if(typeof u!="function")w(g);else try{h(u(g))}catch(p){c&&c(p)}}),typeof f.retry=="function"&&b===f.state&&f.retry()}var h,c,o=new U(function(u,y){h=u,c=y});return m(e,f.resolvers,h,!0),m(n,f.rejectors,c,!1),o};U.prototype.catch=function(e){return this.then(null,e)};U.prototype.finally=function(e){return this.then(function(n){return U.resolve(e()).then(function(){return n})},function(n){return U.resolve(e()).then(function(){return U.reject(n)})})};U.resolve=function(e){return e instanceof U?e:new U(function(n){n(e)})};U.reject=function(e){return new U(function(n,a){a(e)})};U.all=function(e){return new U(function(n,a){var f=e.length,m=0,h=[];if(e.length===0)n([]);else for(var c=0;c<e.length;c++)(function(o){function u(y){m++,h[o]=y,m===f&&n(h)}e[o]!=null&&(typeof e[o]=="object"||typeof e[o]=="function")&&typeof e[o].then=="function"?e[o].then(u,a):u(e[o])})(c)})};U.race=function(e){return new U(function(n,a){for(var f=0;f<e.length;f++)e[f].then(n,a)})};qt.exports=U});var Ve=O((vn,be)=>{"use strict";var he=$e();typeof window!="undefined"?(typeof window.Promise=="undefined"?window.Promise=he:window.Promise.prototype.finally||(window.Promise.prototype.finally=he.prototype.finally),be.exports=window.Promise):typeof global!="undefined"?(typeof global.Promise=="undefined"?global.Promise=he:global.Promise.prototype.finally||(global.Promise.prototype.finally=he.prototype.finally),be.exports=global.Promise):be.exports=he});var St=O((On,Ct)=>{"use strict";var ue=te();Ct.exports=function(e){var n=e&&e.document,a,f={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function m(r){return r.attrs&&r.attrs.xmlns||f[r.tag]}function h(r,t){if(r.state!==t)throw new Error("`vnode.state` must not be modified")}function c(r){var t=r.state;try{return this.apply(t,arguments)}finally{h(r,t)}}function o(){try{return n.activeElement}catch(r){return null}}function u(r,t,i,s,l,d,C){for(var j=i;j<s;j++){var D=t[j];D!=null&&y(r,D,l,C,d)}}function y(r,t,i,s,l){var d=t.tag;if(typeof d=="string")switch(t.state={},t.attrs!=null&&Ae(t.attrs,t,i),d){case"#":w(r,t,l);break;case"<":g(r,t,s,l);break;case"[":p(r,t,i,s,l);break;default:E(r,t,i,s,l)}else q(r,t,i,s,l)}function w(r,t,i){t.dom=n.createTextNode(t.children),ne(r,t.dom,i)}var b={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function g(r,t,i,s){var l=t.children.match(/^\s*?<(\w+)/im)||[],d=n.createElement(b[l[1]]||"div");i==="http://www.w3.org/2000/svg"?(d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",d=d.firstChild):d.innerHTML=t.children,t.dom=d.firstChild,t.domSize=d.childNodes.length,t.instance=[];for(var C=n.createDocumentFragment(),j;j=d.firstChild;)t.instance.push(j),C.appendChild(j);ne(r,C,s)}function p(r,t,i,s,l){var d=n.createDocumentFragment();if(t.children!=null){var C=t.children;u(d,C,0,C.length,i,null,s)}t.dom=d.firstChild,t.domSize=d.childNodes.length,ne(r,d,l)}function E(r,t,i,s,l){var d=t.tag,C=t.attrs,j=C&&C.is;s=m(t)||s;var D=s?j?n.createElementNS(s,d,{is:j}):n.createElementNS(s,d):j?n.createElement(d,{is:j}):n.createElement(d);if(t.dom=D,C!=null&&cr(t,C,s),ne(r,D,l),!ie(t)&&(t.text!=null&&(t.text!==""?D.textContent=t.text:t.children=[ue("#",void 0,void 0,t.text,void 0,void 0)]),t.children!=null)){var I=t.children;u(D,I,0,I.length,i,null,s),t.tag==="select"&&C!=null&&hr(t,C)}}function x(r,t){var i;if(typeof r.tag.view=="function"){if(r.state=Object.create(r.tag),i=r.state.view,i.$$reentrantLock$$!=null)return;i.$$reentrantLock$$=!0}else{if(r.state=void 0,i=r.tag,i.$$reentrantLock$$!=null)return;i.$$reentrantLock$$=!0,r.state=r.tag.prototype!=null&&typeof r.tag.prototype.view=="function"?new r.tag(r):r.tag(r)}if(Ae(r.state,r,t),r.attrs!=null&&Ae(r.attrs,r,t),r.instance=ue.normalize(c.call(r.state.view,r)),r.instance===r)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null}function q(r,t,i,s,l){x(t,i),t.instance!=null?(y(r,t.instance,i,s,l),t.dom=t.instance.dom,t.domSize=t.dom!=null?t.instance.domSize:0):t.domSize=0}function S(r,t,i,s,l,d){if(!(t===i||t==null&&i==null))if(t==null||t.length===0)u(r,i,0,i.length,s,l,d);else if(i==null||i.length===0)Z(r,t,0,t.length);else{var C=t[0]!=null&&t[0].key!=null,j=i[0]!=null&&i[0].key!=null,D=0,I=0;if(!C)for(;I<t.length&&t[I]==null;)I++;if(!j)for(;D<i.length&&i[D]==null;)D++;if(j===null&&C==null)return;if(C!==j)Z(r,t,I,t.length),u(r,i,D,i.length,s,l,d);else if(j){for(var $=t.length-1,_=i.length-1,we,V,z,H,M,Oe;$>=I&&_>=D&&(H=t[$],M=i[_],H.key===M.key);)H!==M&&v(r,H,M,s,l,d),M.dom!=null&&(l=M.dom),$--,_--;for(;$>=I&&_>=D&&(V=t[I],z=i[D],V.key===z.key);)I++,D++,V!==z&&v(r,V,z,s,J(t,I,l),d);for(;$>=I&&_>=D&&!(D===_||V.key!==M.key||H.key!==z.key);)Oe=J(t,I,l),k(r,H,Oe),H!==z&&v(r,H,z,s,Oe,d),++D<=--_&&k(r,V,l),V!==M&&v(r,V,M,s,l,d),M.dom!=null&&(l=M.dom),I++,$--,H=t[$],M=i[_],V=t[I],z=i[D];for(;$>=I&&_>=D&&H.key===M.key;)H!==M&&v(r,H,M,s,l,d),M.dom!=null&&(l=M.dom),$--,_--,H=t[$],M=i[_];if(D>_)Z(r,t,I,$+1);else if(I>$)u(r,i,D,_+1,s,l,d);else{var wr=l,ot=_-D+1,oe=new Array(ot),Le=0,L=0,ze=2147483647,Re=0,we,_e;for(L=0;L<ot;L++)oe[L]=-1;for(L=_;L>=D;L--){we==null&&(we=G(t,I,$+1)),M=i[L];var fe=we[M.key];fe!=null&&(ze=fe<ze?fe:-1,oe[L-D]=fe,H=t[fe],t[fe]=null,H!==M&&v(r,H,M,s,l,d),M.dom!=null&&(l=M.dom),Re++)}if(l=wr,Re!==$-I+1&&Z(r,t,I,$+1),Re===0)u(r,i,D,_+1,s,l,d);else if(ze===-1)for(_e=re(oe),Le=_e.length-1,L=_;L>=D;L--)z=i[L],oe[L-D]===-1?y(r,z,s,d,l):_e[Le]===L-D?Le--:k(r,z,l),z.dom!=null&&(l=i[L].dom);else for(L=_;L>=D;L--)z=i[L],oe[L-D]===-1&&y(r,z,s,d,l),z.dom!=null&&(l=i[L].dom)}}else{var ve=t.length<i.length?t.length:i.length;for(D=D<I?D:I;D<ve;D++)V=t[D],z=i[D],!(V===z||V==null&&z==null)&&(V==null?y(r,z,s,d,J(t,D+1,l)):z==null?de(r,V):v(r,V,z,s,J(t,D+1,l),d));t.length>ve&&Z(r,t,D,t.length),i.length>ve&&u(r,i,D,i.length,s,l,d)}}}function v(r,t,i,s,l,d){var C=t.tag,j=i.tag;if(C===j){if(i.state=t.state,i.events=t.events,yr(i,t))return;if(typeof C=="string")switch(i.attrs!=null&&Me(i.attrs,i,s),C){case"#":A(t,i);break;case"<":W(r,t,i,d,l);break;case"[":R(r,t,i,s,l,d);break;default:P(t,i,s,d)}else B(r,t,i,s,l,d)}else de(r,t),y(r,i,s,d,l)}function A(r,t){r.children.toString()!==t.children.toString()&&(r.dom.nodeValue=t.children),t.dom=r.dom}function W(r,t,i,s,l){t.children!==i.children?(ft(r,t),g(r,i,s,l)):(i.dom=t.dom,i.domSize=t.domSize,i.instance=t.instance)}function R(r,t,i,s,l,d){S(r,t.children,i.children,s,l,d);var C=0,j=i.children;if(i.dom=null,j!=null){for(var D=0;D<j.length;D++){var I=j[D];I!=null&&I.dom!=null&&(i.dom==null&&(i.dom=I.dom),C+=I.domSize||1)}C!==1&&(i.domSize=C)}}function P(r,t,i,s){var l=t.dom=r.dom;s=m(t)||s,t.tag==="textarea"&&(t.attrs==null&&(t.attrs={}),t.text!=null&&(t.attrs.value=t.text,t.text=void 0)),pr(t,r.attrs,t.attrs,s),ie(t)||(r.text!=null&&t.text!=null&&t.text!==""?r.text.toString()!==t.text.toString()&&(r.dom.firstChild.nodeValue=t.text):(r.text!=null&&(r.children=[ue("#",void 0,void 0,r.text,void 0,r.dom.firstChild)]),t.text!=null&&(t.children=[ue("#",void 0,void 0,t.text,void 0,void 0)]),S(l,r.children,t.children,i,null,s)))}function B(r,t,i,s,l,d){if(i.instance=ue.normalize(c.call(i.state.view,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");Me(i.state,i,s),i.attrs!=null&&Me(i.attrs,i,s),i.instance!=null?(t.instance==null?y(r,i.instance,s,d,l):v(r,t.instance,i.instance,s,l,d),i.dom=i.instance.dom,i.domSize=i.instance.domSize):t.instance!=null?(de(r,t.instance),i.dom=void 0,i.domSize=0):(i.dom=t.dom,i.domSize=t.domSize)}function G(r,t,i){for(var s=Object.create(null);t<i;t++){var l=r[t];if(l!=null){var d=l.key;d!=null&&(s[d]=t)}}return s}var Q=[];function re(r){for(var t=[0],i=0,s=0,l=0,d=Q.length=r.length,l=0;l<d;l++)Q[l]=r[l];for(var l=0;l<d;++l)if(r[l]!==-1){var C=t[t.length-1];if(r[C]<r[l]){Q[l]=C,t.push(l);continue}for(i=0,s=t.length-1;i<s;){var j=(i>>>1)+(s>>>1)+(i&s&1);r[t[j]]<r[l]?i=j+1:s=j}r[l]<r[t[i]]&&(i>0&&(Q[l]=t[i-1]),t[i]=l)}for(i=t.length,s=t[i-1];i-- >0;)t[i]=s,s=Q[s];return Q.length=0,t}function J(r,t,i){for(;t<r.length;t++)if(r[t]!=null&&r[t].dom!=null)return r[t].dom;return i}function k(r,t,i){var s=n.createDocumentFragment();ge(r,s,t),ne(r,s,i)}function ge(r,t,i){for(;i.dom!=null&&i.dom.parentNode===r;){if(typeof i.tag!="string"){if(i=i.instance,i!=null)continue}else if(i.tag==="<")for(var s=0;s<i.instance.length;s++)t.appendChild(i.instance[s]);else if(i.tag!=="[")t.appendChild(i.dom);else if(i.children.length===1){if(i=i.children[0],i!=null)continue}else for(var s=0;s<i.children.length;s++){var l=i.children[s];l!=null&&ge(r,t,l)}break}}function ne(r,t,i){i!=null?r.insertBefore(t,i):r.appendChild(t)}function ie(r){if(r.attrs==null||r.attrs.contenteditable==null&&r.attrs.contentEditable==null)return!1;var t=r.children;if(t!=null&&t.length===1&&t[0].tag==="<"){var i=t[0].children;r.dom.innerHTML!==i&&(r.dom.innerHTML=i)}else if(r.text!=null||t!=null&&t.length!==0)throw new Error("Child node of a contenteditable must be trusted");return!0}function Z(r,t,i,s){for(var l=i;l<s;l++){var d=t[l];d!=null&&de(r,d)}}function de(r,t){var i=0,s=t.state,l,d;if(typeof t.tag!="string"&&typeof t.state.onbeforeremove=="function"){var C=c.call(t.state.onbeforeremove,t);C!=null&&typeof C.then=="function"&&(i=1,l=C)}if(t.attrs&&typeof t.attrs.onbeforeremove=="function"){var C=c.call(t.attrs.onbeforeremove,t);C!=null&&typeof C.then=="function"&&(i|=2,d=C)}if(h(t,s),!i)ye(t),Se(r,t);else{if(l!=null){var j=function(){i&1&&(i&=2,i||D())};l.then(j,j)}if(d!=null){var j=function(){i&2&&(i&=1,i||D())};d.then(j,j)}}function D(){h(t,s),ye(t),Se(r,t)}}function ft(r,t){for(var i=0;i<t.instance.length;i++)r.removeChild(t.instance[i])}function Se(r,t){for(;t.dom!=null&&t.dom.parentNode===r;){if(typeof t.tag!="string"){if(t=t.instance,t!=null)continue}else if(t.tag==="<")ft(r,t);else{if(t.tag!=="["&&(r.removeChild(t.dom),!Array.isArray(t.children)))break;if(t.children.length===1){if(t=t.children[0],t!=null)continue}else for(var i=0;i<t.children.length;i++){var s=t.children[i];s!=null&&Se(r,s)}}break}}function ye(r){if(typeof r.tag!="string"&&typeof r.state.onremove=="function"&&c.call(r.state.onremove,r),r.attrs&&typeof r.attrs.onremove=="function"&&c.call(r.attrs.onremove,r),typeof r.tag!="string")r.instance!=null&&ye(r.instance);else{var t=r.children;if(Array.isArray(t))for(var i=0;i<t.length;i++){var s=t[i];s!=null&&ye(s)}}}function cr(r,t,i){for(var s in t)je(r,s,null,t[s],i)}function je(r,t,i,s,l){if(!(t==="key"||t==="is"||s==null||Ie(t)||i===s&&!mr(r,t)&&typeof s!="object")){if(t[0]==="o"&&t[1]==="n")return ct(r,t,s);if(t.slice(0,6)==="xlink:")r.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),s);else if(t==="style")ut(r.dom,i,s);else if(lt(r,t,l)){if(t==="value"&&((r.tag==="input"||r.tag==="textarea")&&r.dom.value===""+s&&r.dom===o()||r.tag==="select"&&i!==null&&r.dom.value===""+s||r.tag==="option"&&i!==null&&r.dom.value===""+s))return;r.tag==="input"&&t==="type"?r.dom.setAttribute(t,s):r.dom[t]=s}else typeof s=="boolean"?s?r.dom.setAttribute(t,""):r.dom.removeAttribute(t):r.dom.setAttribute(t==="className"?"class":t,s)}}function or(r,t,i,s){if(!(t==="key"||t==="is"||i==null||Ie(t)))if(t[0]==="o"&&t[1]==="n"&&!Ie(t))ct(r,t,void 0);else if(t==="style")ut(r.dom,i,null);else if(lt(r,t,s)&&t!=="className"&&!(t==="value"&&(r.tag==="option"||r.tag==="select"&&r.dom.selectedIndex===-1&&r.dom===o()))&&!(r.tag==="input"&&t==="type"))r.dom[t]=null;else{var l=t.indexOf(":");l!==-1&&(t=t.slice(l+1)),i!==!1&&r.dom.removeAttribute(t==="className"?"class":t)}}function hr(r,t){if("value"in t)if(t.value===null)r.dom.selectedIndex!==-1&&(r.dom.value=null);else{var i=""+t.value;(r.dom.value!==i||r.dom.selectedIndex===-1)&&(r.dom.value=i)}"selectedIndex"in t&&je(r,"selectedIndex",null,t.selectedIndex,void 0)}function pr(r,t,i,s){if(i!=null)for(var l in i)je(r,l,t&&t[l],i[l],s);var d;if(t!=null)for(var l in t)(d=t[l])!=null&&(i==null||i[l]==null)&&or(r,l,d,s)}function mr(r,t){return t==="value"||t==="checked"||t==="selectedIndex"||t==="selected"&&r.dom===o()||r.tag==="option"&&r.dom.parentNode===n.activeElement}function Ie(r){return r==="oninit"||r==="oncreate"||r==="onupdate"||r==="onremove"||r==="onbeforeremove"||r==="onbeforeupdate"}function lt(r,t,i){return i===void 0&&(r.tag.indexOf("-")>-1||r.attrs!=null&&r.attrs.is||t!=="href"&&t!=="list"&&t!=="form"&&t!=="width"&&t!=="height")&&t in r.dom}var gr=/[A-Z]/g;function dr(r){return"-"+r.toLowerCase()}function Pe(r){return r[0]==="-"&&r[1]==="-"?r:r==="cssFloat"?"float":r.replace(gr,dr)}function ut(r,t,i){if(t!==i)if(i==null)r.style.cssText="";else if(typeof i!="object")r.style.cssText=i;else if(t==null||typeof t!="object"){r.style.cssText="";for(var s in i){var l=i[s];l!=null&&r.style.setProperty(Pe(s),String(l))}}else{for(var s in i){var l=i[s];l!=null&&(l=String(l))!==String(t[s])&&r.style.setProperty(Pe(s),l)}for(var s in t)t[s]!=null&&i[s]==null&&r.style.removeProperty(Pe(s))}}function Ne(){this._=a}Ne.prototype=Object.create(null),Ne.prototype.handleEvent=function(r){var t=this["on"+r.type],i;typeof t=="function"?i=t.call(r.currentTarget,r):typeof t.handleEvent=="function"&&t.handleEvent(r),this._&&r.redraw!==!1&&(0,this._)(),i===!1&&(r.preventDefault(),r.stopPropagation())};function ct(r,t,i){if(r.events!=null){if(r.events[t]===i)return;i!=null&&(typeof i=="function"||typeof i=="object")?(r.events[t]==null&&r.dom.addEventListener(t.slice(2),r.events,!1),r.events[t]=i):(r.events[t]!=null&&r.dom.removeEventListener(t.slice(2),r.events,!1),r.events[t]=void 0)}else i!=null&&(typeof i=="function"||typeof i=="object")&&(r.events=new Ne,r.dom.addEventListener(t.slice(2),r.events,!1),r.events[t]=i)}function Ae(r,t,i){typeof r.oninit=="function"&&c.call(r.oninit,t),typeof r.oncreate=="function"&&i.push(c.bind(r.oncreate,t))}function Me(r,t,i){typeof r.onupdate=="function"&&i.push(c.bind(r.onupdate,t))}function yr(r,t){do{if(r.attrs!=null&&typeof r.attrs.onbeforeupdate=="function"){var i=c.call(r.attrs.onbeforeupdate,r,t);if(i!==void 0&&!i)break}if(typeof r.tag!="string"&&typeof r.state.onbeforeupdate=="function"){var i=c.call(r.state.onbeforeupdate,r,t);if(i!==void 0&&!i)break}return!1}while(!1);return r.dom=t.dom,r.domSize=t.domSize,r.instance=t.instance,r.attrs=t.attrs,r.children=t.children,r.text=t.text,!0}return function(r,t,i){if(!r)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var s=[],l=o(),d=r.namespaceURI;r.vnodes==null&&(r.textContent=""),t=ue.normalizeChildren(Array.isArray(t)?t:[t]);var C=a;try{a=typeof i=="function"?i:void 0,S(r,r.vnodes,t,s,null,d==="http://www.w3.org/1999/xhtml"?void 0:d)}finally{a=C}r.vnodes=t,l!=null&&o()!==l&&typeof l.focus=="function"&&l.focus();for(var j=0;j<s.length;j++)s[j]()}}});var Ke=O((Ln,jt)=>{"use strict";jt.exports=St()(window)});var Nt=O((zn,It)=>{"use strict";var Pt=te();It.exports=function(e,n,a){var f=[],m=!1,h=!1;function c(){if(m)throw new Error("Nested m.redraw.sync() call");m=!0;for(var y=0;y<f.length;y+=2)try{e(f[y],Pt(f[y+1]),o)}catch(w){a.error(w)}m=!1}function o(){h||(h=!0,n(function(){h=!1,c()}))}o.sync=c;function u(y,w){if(w!=null&&w.view==null&&typeof w!="function")throw new TypeError("m.mount(element, component) expects a component, not a vnode");var b=f.indexOf(y);b>=0&&(f.splice(b,2),e(y,[],o)),w!=null&&(f.push(y,w),e(y,Pt(w),o))}return{mount:u,redraw:o}}});var xe=O((Rn,At)=>{"use strict";var zr=Ke();At.exports=Nt()(zr,requestAnimationFrame,console)});var Qe=O((_n,Mt)=>{"use strict";Mt.exports=function(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var n=[];for(var a in e)f(a,e[a]);return n.join("&");function f(m,h){if(Array.isArray(h))for(var c=0;c<h.length;c++)f(m+"["+c+"]",h[c]);else if(Object.prototype.toString.call(h)==="[object Object]")for(var c in h)f(m+"["+c+"]",h[c]);else n.push(encodeURIComponent(m)+(h!=null&&h!==""?"="+encodeURIComponent(h):""))}}});var ke=O((Un,vt)=>{"use strict";vt.exports=Object.assign||function(e,n){n&&Object.keys(n).forEach(function(a){e[a]=n[a]})}});var Ee=O((Bn,Ot)=>{"use strict";var Rr=Qe(),_r=ke();Ot.exports=function(e,n){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(n==null)return e;var a=e.indexOf("?"),f=e.indexOf("#"),m=f<0?e.length:f,h=a<0?m:a,c=e.slice(0,h),o={};_r(o,n);var u=c.replace(/:([^\/\.-]+)(\.{3})?/g,function(x,q,S){return delete o[q],n[q]==null?x:S?n[q]:encodeURIComponent(String(n[q]))}),y=u.indexOf("?"),w=u.indexOf("#"),b=w<0?u.length:w,g=y<0?b:y,p=u.slice(0,g);a>=0&&(p+=e.slice(a,m)),y>=0&&(p+=(a<0?"?":"&")+u.slice(y,b));var E=Rr(o);return E&&(p+=(a<0&&y<0?"?":"&")+E),f>=0&&(p+=e.slice(f)),w>=0&&(p+=(f<0?"":"&")+u.slice(w)),p}});var zt=O((Hn,Lt)=>{"use strict";var Ur=Ee();Lt.exports=function(e,n,a){var f=0;function m(o){return new n(o)}m.prototype=n.prototype,m.__proto__=n;function h(o){return function(u,y){typeof u!="string"?(y=u,u=u.url):y==null&&(y={});var w=new n(function(E,x){o(Ur(u,y.params),y,function(q){if(typeof y.type=="function")if(Array.isArray(q))for(var S=0;S<q.length;S++)q[S]=new y.type(q[S]);else q=new y.type(q);E(q)},x)});if(y.background===!0)return w;var b=0;function g(){--b==0&&typeof a=="function"&&a()}return p(w);function p(E){var x=E.then;return E.constructor=m,E.then=function(){b++;var q=x.apply(E,arguments);return q.then(g,function(S){if(g(),b===0)throw S}),p(q)},E}}}function c(o,u){for(var y in o.headers)if({}.hasOwnProperty.call(o.headers,y)&&u.test(y))return!0;return!1}return{request:h(function(o,u,y,w){var b=u.method!=null?u.method.toUpperCase():"GET",g=u.body,p=(u.serialize==null||u.serialize===JSON.serialize)&&!(g instanceof e.FormData),E=u.responseType||(typeof u.extract=="function"?"":"json"),x=new e.XMLHttpRequest,q=!1,S=x,v,A=x.abort;x.abort=function(){q=!0,A.call(this)},x.open(b,o,u.async!==!1,typeof u.user=="string"?u.user:void 0,typeof u.password=="string"?u.password:void 0),p&&g!=null&&!c(u,/^content-type$/i)&&x.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof u.deserialize!="function"&&!c(u,/^accept$/i)&&x.setRequestHeader("Accept","application/json, text/*"),u.withCredentials&&(x.withCredentials=u.withCredentials),u.timeout&&(x.timeout=u.timeout),x.responseType=E;for(var W in u.headers)({}).hasOwnProperty.call(u.headers,W)&&x.setRequestHeader(W,u.headers[W]);x.onreadystatechange=function(R){if(!q&&R.target.readyState===4)try{var P=R.target.status>=200&&R.target.status<300||R.target.status===304||/^file:\/\//i.test(o),B=R.target.response,G;if(E==="json"?!R.target.responseType&&typeof u.extract!="function"&&(B=JSON.parse(R.target.responseText)):(!E||E==="text")&&B==null&&(B=R.target.responseText),typeof u.extract=="function"?(B=u.extract(R.target,u),P=!0):typeof u.deserialize=="function"&&(B=u.deserialize(B)),P)y(B);else{try{G=R.target.responseText}catch(re){G=B}var Q=new Error(G);Q.code=R.target.status,Q.response=B,w(Q)}}catch(re){w(re)}},typeof u.config=="function"&&(x=u.config(x,u,o)||x,x!==S&&(v=x.abort,x.abort=function(){q=!0,v.call(this)})),g==null?x.send():typeof u.serialize=="function"?x.send(u.serialize(g)):g instanceof e.FormData?x.send(g):x.send(JSON.stringify(g))}),jsonp:h(function(o,u,y,w){var b=u.callbackName||"_mithril_"+Math.round(Math.random()*1e16)+"_"+f++,g=e.document.createElement("script");e[b]=function(p){delete e[b],g.parentNode.removeChild(g),y(p)},g.onerror=function(){delete e[b],g.parentNode.removeChild(g),w(new Error("JSONP request failed"))},g.src=o+(o.indexOf("?")<0?"?":"&")+encodeURIComponent(u.callbackKey||"callback")+"="+encodeURIComponent(b),e.document.documentElement.appendChild(g)})}}});var _t=O((Fn,Rt)=>{"use strict";var Br=Ve(),Hr=xe();Rt.exports=zt()(window,Br,Hr.redraw)});var We=O(($n,Ut)=>{"use strict";Ut.exports=function(e){if(e===""||e==null)return{};e.charAt(0)==="?"&&(e=e.slice(1));for(var n=e.split("&"),a={},f={},m=0;m<n.length;m++){var h=n[m].split("="),c=decodeURIComponent(h[0]),o=h.length===2?decodeURIComponent(h[1]):"";o==="true"?o=!0:o==="false"&&(o=!1);var u=c.split(/\]\[?|\[/),y=f;c.indexOf("[")>-1&&u.pop();for(var w=0;w<u.length;w++){var b=u[w],g=u[w+1],p=g==""||!isNaN(parseInt(g,10));if(b===""){var c=u.slice(0,w).join();a[c]==null&&(a[c]=Array.isArray(y)?y.length:0),b=a[c]++}else if(b==="__proto__")break;if(w===u.length-1)y[b]=o;else{var E=Object.getOwnPropertyDescriptor(y,b);E!=null&&(E=E.value),E==null&&(y[b]=E=p?[]:{}),y=E}}}return f}});var De=O((Vn,Bt)=>{"use strict";var Fr=We();Bt.exports=function(e){var n=e.indexOf("?"),a=e.indexOf("#"),f=a<0?e.length:a,m=n<0?f:n,h=e.slice(0,m).replace(/\/{2,}/g,"/");return h?(h[0]!=="/"&&(h="/"+h),h.length>1&&h[h.length-1]==="/"&&(h=h.slice(0,-1))):h="/",{path:h,params:n<0?{}:Fr(e.slice(n+1,f))}}});var Ft=O((Kn,Ht)=>{"use strict";var $r=De();Ht.exports=function(e){var n=$r(e),a=Object.keys(n.params),f=[],m=new RegExp("^"+n.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(h,c,o){return c==null?"\\"+h:(f.push({k:c,r:o==="..."}),o==="..."?"(.*)":o==="."?"([^/]+)\\.":"([^/]+)"+(o||""))})+"$");return function(h){for(var c=0;c<a.length;c++)if(n.params[a[c]]!==h.params[a[c]])return!1;if(!f.length)return m.test(h.path);var o=m.exec(h.path);if(o==null)return!1;for(var c=0;c<f.length;c++)h.params[f[c].k]=f[c].r?o[c+1]:decodeURIComponent(o[c+1]);return!0}}});var Qt=O((Qn,$t)=>{"use strict";var Vr=te(),Kr=He(),Qr=Ve(),kr=Ee(),Vt=De(),Wr=Ft(),Kt=ke(),Je={};$t.exports=function(e,n){var a;function f(b,g,p){if(b=kr(b,g),a!=null){a();var E=p?p.state:null,x=p?p.title:null;p&&p.replace?e.history.replaceState(E,x,w.prefix+b):e.history.pushState(E,x,w.prefix+b)}else e.location.href=w.prefix+b}var m=Je,h,c,o,u,y=w.SKIP={};function w(b,g,p){if(b==null)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var E=0,x=Object.keys(p).map(function(P){if(P[0]!=="/")throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(P))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:P,component:p[P],check:Wr(P)}}),q=typeof setImmediate=="function"?setImmediate:setTimeout,S=Qr.resolve(),v=!1,A;if(a=null,g!=null){var W=Vt(g);if(!x.some(function(P){return P.check(W)}))throw new ReferenceError("Default route doesn't match any known routes")}function R(){v=!1;var P=e.location.hash;w.prefix[0]!=="#"&&(P=e.location.search+P,w.prefix[0]!=="?"&&(P=e.location.pathname+P,P[0]!=="/"&&(P="/"+P)));var B=P.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(w.prefix.length),G=Vt(B);Kt(G.params,e.history.state);function Q(){if(B===g)throw new Error("Could not resolve default route "+g);f(g,null,{replace:!0})}re(0);function re(J){for(;J<x.length;J++)if(x[J].check(G)){var k=x[J].component,ge=x[J].route,ne=k,ie=u=function(Z){if(ie===u){if(Z===y)return re(J+1);h=Z!=null&&(typeof Z.view=="function"||typeof Z=="function")?Z:"div",c=G.params,o=B,u=null,m=k.render?k:null,E===2?n.redraw():(E=2,n.redraw.sync())}};k.view||typeof k=="function"?(k={},ie(ne)):k.onmatch?S.then(function(){return k.onmatch(G.params,B,ge)}).then(ie,Q):ie("div");return}Q()}}return a=function(){v||(v=!0,q(R))},typeof e.history.pushState=="function"?(A=function(){e.removeEventListener("popstate",a,!1)},e.addEventListener("popstate",a,!1)):w.prefix[0]==="#"&&(a=null,A=function(){e.removeEventListener("hashchange",R,!1)},e.addEventListener("hashchange",R,!1)),n.mount(b,{onbeforeupdate:function(){return E=E?2:1,!(!E||Je===m)},oncreate:R,onremove:A,view:function(){if(!(!E||Je===m)){var P=[Vr(h,c.key,c)];return m&&(P=m.render(P[0])),P}}})}return w.set=function(b,g,p){u!=null&&(p=p||{},p.replace=!0),u=null,f(b,g,p)},w.get=function(){return o},w.prefix="#!",w.Link={view:function(b){var g=b.attrs.options,p={},E,x;Kt(p,b.attrs),p.selector=p.options=p.key=p.oninit=p.oncreate=p.onbeforeupdate=p.onupdate=p.onbeforeremove=p.onremove=null;var q=Kr(b.attrs.selector||"a",p,b.children);return(q.attrs.disabled=Boolean(q.attrs.disabled))?(q.attrs.href=null,q.attrs["aria-disabled"]="true",q.attrs.onclick=null):(E=q.attrs.onclick,x=q.attrs.href,q.attrs.href=w.prefix+x,q.attrs.onclick=function(S){var v;typeof E=="function"?v=E.call(S.currentTarget,S):E==null||typeof E!="object"||typeof E.handleEvent=="function"&&E.handleEvent(S),v!==!1&&!S.defaultPrevented&&(S.button===0||S.which===0||S.which===1)&&(!S.currentTarget.target||S.currentTarget.target==="_self")&&!S.ctrlKey&&!S.metaKey&&!S.shiftKey&&!S.altKey&&(S.preventDefault(),S.redraw=!1,w.set(x,null,g))}),q}},w.param=function(b){return c&&b!=null?c[b]:c},w}});var Wt=O((kn,kt)=>{"use strict";var Jr=xe();kt.exports=Qt()(window,Jr)});var Gt=O((Wn,Jt)=>{"use strict";var Te=Tt(),Zt=_t(),Yt=xe(),F=function(){return Te.apply(this,arguments)};F.m=Te;F.trust=Te.trust;F.fragment=Te.fragment;F.mount=Yt.mount;F.route=Wt();F.render=Ke();F.redraw=Yt.redraw;F.request=Zt.request;F.jsonp=Zt.jsonp;F.parseQueryString=We();F.buildQueryString=Qe();F.parsePathname=De();F.buildPathname=Ee();F.vnode=te();F.PromisePolyfill=$e();Jt.exports=F});var N=Sr(Gt());var Zr=(e,n)=>n.some(a=>e instanceof a),Xt,er;function Yr(){return Xt||(Xt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Gr(){return er||(er=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var tr=new WeakMap,Ze=new WeakMap,rr=new WeakMap,Ye=new WeakMap,Ge=new WeakMap;function Xr(e){let n=new Promise((a,f)=>{let m=()=>{e.removeEventListener("success",h),e.removeEventListener("error",c)},h=()=>{a(X(e.result)),m()},c=()=>{f(e.error),m()};e.addEventListener("success",h),e.addEventListener("error",c)});return n.then(a=>{a instanceof IDBCursor&&tr.set(a,e)}).catch(()=>{}),Ge.set(n,e),n}function en(e){if(Ze.has(e))return;let n=new Promise((a,f)=>{let m=()=>{e.removeEventListener("complete",h),e.removeEventListener("error",c),e.removeEventListener("abort",c)},h=()=>{a(),m()},c=()=>{f(e.error||new DOMException("AbortError","AbortError")),m()};e.addEventListener("complete",h),e.addEventListener("error",c),e.addEventListener("abort",c)});Ze.set(e,n)}var Xe={get(e,n,a){if(e instanceof IDBTransaction){if(n==="done")return Ze.get(e);if(n==="objectStoreNames")return e.objectStoreNames||rr.get(e);if(n==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return X(e[n])},set(e,n,a){return e[n]=a,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function nr(e){Xe=e(Xe)}function tn(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...a){let f=e.call(qe(this),n,...a);return rr.set(f,n.sort?n.sort():[n]),X(f)}:Gr().includes(e)?function(...n){return e.apply(qe(this),n),X(tr.get(this))}:function(...n){return X(e.apply(qe(this),n))}}function rn(e){return typeof e=="function"?tn(e):(e instanceof IDBTransaction&&en(e),Zr(e,Yr())?new Proxy(e,Xe):e)}function X(e){if(e instanceof IDBRequest)return Xr(e);if(Ye.has(e))return Ye.get(e);let n=rn(e);return n!==e&&(Ye.set(e,n),Ge.set(n,e)),n}var qe=e=>Ge.get(e);function ir(e,n,{blocked:a,upgrade:f,blocking:m,terminated:h}={}){let c=indexedDB.open(e,n),o=X(c);return f&&c.addEventListener("upgradeneeded",u=>{f(X(c.result),u.oldVersion,u.newVersion,X(c.transaction))}),a&&c.addEventListener("blocked",()=>a()),o.then(u=>{h&&u.addEventListener("close",()=>h()),m&&u.addEventListener("versionchange",()=>m())}).catch(()=>{}),o}var nn=["get","getKey","getAll","getAllKeys","count"],an=["put","add","delete","clear"],et=new Map;function ar(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(et.get(n))return et.get(n);let a=n.replace(/FromIndex$/,""),f=n!==a,m=an.includes(a);if(!(a in(f?IDBIndex:IDBObjectStore).prototype)||!(m||nn.includes(a)))return;let h=async function(c,...o){let u=this.transaction(c,m?"readwrite":"readonly"),y=u.store;return f&&(y=y.index(o.shift())),(await Promise.all([y[a](...o),m&&u.done]))[0]};return et.set(n,h),h}nr(e=>({...e,get:(n,a,f)=>ar(n,a)||e.get(n,a,f),has:(n,a)=>!!ar(n,a)||e.has(n,a)}));function pe(e){if(e===null||e===!0||e===!1)return NaN;var n=Number(e);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}function Y(e,n){if(n.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+n.length+" present")}function se(e){Y(1,arguments);var n=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&n==="[object Date]"?new Date(e.getTime()):typeof e=="number"||n==="[object Number]"?new Date(e):((typeof e=="string"||n==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function tt(e,n){Y(2,arguments);var a=se(e).getTime(),f=pe(n);return new Date(a+f)}var Ce=6e4;function sr(e){return e.getTime()%Ce}function rt(e){var n=new Date(e.getTime()),a=Math.ceil(n.getTimezoneOffset());n.setSeconds(0,0);var f=a>0,m=f?(Ce+sr(n))%Ce:sr(n);return a*Ce+m}function nt(e){Y(1,arguments);var n=se(e);return!isNaN(n)}function it(e,n){Y(2,arguments);var a=pe(n);return tt(e,-a)}function ee(e,n){for(var a=e<0?"-":"",f=Math.abs(e).toString();f.length<n;)f="0"+f;return a+f}var sn={y:function(e,n){var a=e.getUTCFullYear(),f=a>0?a:1-a;return ee(n==="yy"?f%100:f,n.length)},M:function(e,n){var a=e.getUTCMonth();return n==="M"?String(a+1):ee(a+1,2)},d:function(e,n){return ee(e.getUTCDate(),n.length)},a:function(e,n){var a=e.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h:function(e,n){return ee(e.getUTCHours()%12||12,n.length)},H:function(e,n){return ee(e.getUTCHours(),n.length)},m:function(e,n){return ee(e.getUTCMinutes(),n.length)},s:function(e,n){return ee(e.getUTCSeconds(),n.length)},S:function(e,n){var a=n.length,f=e.getUTCMilliseconds(),m=Math.floor(f*Math.pow(10,a-3));return ee(m,n.length)}},fr=sn;var fn=/(\w)\1*|''|'(''|[^'])+('|$)|./g,ln=/^'([^]*?)'?$/,un=/''/g,cn=/[a-zA-Z]/;function at(e,n){Y(2,arguments);var a=String(n),f=se(e);if(!nt(f))throw new RangeError("Invalid time value");var m=rt(f),h=it(f,m),c=a.match(fn).map(function(o){if(o==="''")return"'";var u=o[0];if(u==="'")return on(o);var y=fr[u];if(y)return y(h,o,null,{});if(u.match(cn))throw new RangeError("Format string contains an unescaped latin alphabet character `"+u+"`");return o}).join("");return c}function on(e){return e.match(ln)[1].replace(un,"'")}var st=ir("minoteaur",1,{upgrade:(e,n)=>{n<1&&e.createObjectStore("drafts")},blocking:()=>{window.location.reload()}});st.then(e=>{window.idb=e});var K={showingSearchDialog:!1,searchResults:[],searchError:null,searchQuery:""},hn=([e,...n])=>e.toLowerCase()+n.join(""),pn=([e,...n])=>e.toUpperCase()+n.join(""),mn=e=>e.split(/[ _]/).map(hn).join("_"),gn=e=>e.split(/[ _]/).map(pn).join(" "),me=(e,n)=>{let a=`/${encodeURIComponent(mn(e))}`;return n&&(a+="/"+n),a},dn=e=>{window.lastError=e,console.warn(e);let n=`HTTP error ${e.code}`;e.message!==null&&(n+=" "+e.message),K.searchError=n},yn=e=>{let n=e.target.value;K.searchQuery=n,N.default.request({url:"/api/search",params:{q:n}}).then(a=>{typeof a=="string"?(console.warn(a),K.searchError=a):(K.searchResults=a,K.searchError=null)},dn)},ce=gn(decodeURIComponent(/^\/([^/]+)/.exec(location.pathname)[1]).replace(/\+/g," ")),wn=e=>{if(e.code==="Enter"){let n=K.searchResults.filter(a=>a.page!==ce);n[0]&&(location.href=me(n[0].page))}},bn={view:()=>N.default(".dialog.search",[N.default("h1","Search"),N.default("input[type=search]",{placeholder:"Query",oninput:yn,onkeydown:wn,value:K.searchQuery,oncreate:({dom:e})=>e.focus()}),K.searchError&&N.default(".error",K.searchError),N.default("ul",K.searchResults.map(e=>N.default("li",[N.default(".flex-space",[N.default("a.wikilink",{href:me(e.page)},e.page),N.default("",e.rank.toFixed(3))]),N.default("",e.snippet.map(n=>n[0]?N.default("span.highlight",n[1]):n[1]))])))])},xn={view:()=>N.default("",K.showingSearchDialog?N.default(bn):null)},lr=document.createElement("div");document.querySelector("main").insertBefore(lr,document.querySelector(".header"));N.default.mount(lr,xn);var En=document.querySelector("nav .search");En.addEventListener("click",e=>{K.showingSearchDialog=!K.showingSearchDialog,e.preventDefault(),N.default.redraw()});document.body.addEventListener("keydown",e=>{e.target===document.body&&(e.key==="e"?location.pathname=me(ce,"edit"):e.key==="v"?location.pathname=me(ce):e.key==="r"?location.pathname=me(ce,"revisions"):e.key==="/"&&(K.showingSearchDialog=!K.showingSearchDialog,e.preventDefault(),N.default.redraw()))});var Dn=(e,n=250)=>{let a;return()=>{clearTimeout(a),a=setTimeout(e,n)}},ur=e=>at(e,"yyyy-MM-dd HH:mm:ss"),Tn=e=>{let n=0;for(let a of e.split(/\s+/))/[^#*+>|`-]/.test(a)&&(n+=1);return n},qn=e=>e.split(`
`).length,T=document.querySelector(".edit-form textarea");if(T){let e={keypresses:0,draftSelected:!1},n=document.createElement("div");document.querySelector(".sidebar").appendChild(n);let a=Infinity,f=()=>{let g=document.body.scrollTop;(T.scrollHeight+2!=T.style.height.slice(0,-2)||a>T.value.length)&&(T.style.height=0,T.style.height=T.scrollHeight+2,document.body.scrollTop=g),a=T.value.length},m=parseInt(document.querySelector("input[name=last-edit]").value),h=T.value,c=()=>{!e.initialDraft||(e.draftSelected=!0,T.value=e.initialDraft.text,f())},o=()=>{console.log("server value swapped in, allegedly?"),e.draftSelected=!1,console.log(T.value,h),T.value=h,f()};st.then(g=>g.get("drafts",ce)).then(g=>{e.initialDraft=g,console.log("loaded memetic/beemetic entity ",g),g.ts>m&&c(),N.default.redraw()});let u={view:()=>e.initialDraft==null?"No draft":[N.default(e.draftSelected?".selected":"",{onclick:c},`Draft from ${ur(e.initialDraft.ts)}`),m>0&&N.default(e.draftSelected?"":".selected",{onclick:o},`Page from ${ur(m)}`)]},y={view:()=>[N.default("",`${e.chars} chars`),N.default("",`${e.words} words`),N.default("",`${e.lines} lines`),N.default("",`${e.keypresses} keypresses`),N.default(u)]},w=g=>{e.words=Tn(g),e.lines=qn(g),e.chars=g.length};w(T.value),N.default.mount(n,y),T.addEventListener("keypress",g=>{let p=T.selectionStart,E=T.selectionEnd;if(p!==E)return;let x=`
`+T.value.substr(0,p),q=x.lastIndexOf(`
`)+1,S=p+(T.value.substr(p)+`
`).indexOf(`
`);if(g.code==="Enter"){if(g.ctrlKey){T.parentElement.submit();return}let v=x.substr(q),A=/^(\s*)(([*+-])|(\d+)([).]))(\s*)/.exec(v);if(A){let W=A[1]+(A[4]?(parseInt(A[4])+1).toString()+A[5]:A[2])+A[6],R=T.value.slice(p,S),P=T.value.substr(0,p)+`
`+W;T.value=P+R+T.value.substr(S),T.selectionStart=T.selectionEnd=P.length,f(),g.preventDefault()}}}),T.addEventListener("keydown",g=>{let p=T.selectionStart,E=T.selectionEnd;if(p!==E)return;let q=(`
`+T.value.substr(0,p)).lastIndexOf(`
`),S=p+(T.value.substr(p)+`
`).indexOf(`
`);if(g.code==="Backspace"){if(/^\s*([*+-]|\d+[).])\s*$/y.test(T.value.slice(q,p))){let A=T.value.substr(0,q),W=T.value.substr(p);T.value=A+W,T.selectionStart=T.selectionEnd=A.length,f(),g.preventDefault()}}else if(g.code==="Tab"){let v=/^(\s*)([*+-]|\d+[).])/.exec(T.value.slice(q,S)),A=T.value.substr(q);g.shiftKey?A=A.replace(/^  /,""):A="  "+A,v&&(T.value=T.value.substr(0,q)+A,T.selectionStart=T.selectionEnd=p+(g.shiftKey?-2:2),f(),g.preventDefault())}e.keypresses++,N.default.redraw()});let b=Dn(()=>{st.then(g=>g.put("drafts",{text:T.value,ts:Date.now()},ce)),console.log("saved")});T.addEventListener("input",()=>{f(),w(T.value),b()}),f()}})();
//# sourceMappingURL=client.js.map
